from pwn import *

import os
import json
import base64

# Provided by fireball
# con = remote(os.environ["HOST"], os.environ["PORT"])
a,b = os.environ["HOST"], os.environ["PORT"]
# print("Hello, World!")
# print("Hello, stderr!", file=sys.stderr)

# con.recvuntil(b"1234")
# con.sendline(b"Test test")

# 모든 flag는 jwt로 제공됨, jwt는 test를 위해 임의로 설정한 변수
# jwt = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjaGFsbElkIjoxLCJmbGFnIjoidGVzdHRlc3QiLCJnYW1lYm94SWQiOjEsInBsYWNlIjowLCJyb3VuZCI6NywidGVhbUlkIjoxLCJpYXQiOjE2NjgwMDUxNzF9.XwiQA_Za-r1fuQdGrLzm0FuEp_3qhCx8itJ8mdXVr6Y'

flag = json.loads(base64.b64decode(jwt.split(".")[1]))['flag']

with open("/tmp/flag","w") as f:
    f.write(flag)
